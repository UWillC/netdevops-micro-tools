{
  "cve_id": "CVE-2024-20359",

  "risk_summary": "Persistent backdoor vulnerability in ASA/FTD. Attacker with admin access can install malware that survives reboots. Used in ArcaneDoor campaign. CVSS 6.0 but HIGH impact due to persistence.",

  "attack_vector": "Attacker with administrative access exploits flaw to install persistent malware in flash. Backdoor survives device reboot. Part of sophisticated ArcaneDoor campaign targeting government networks.",

  "workaround_steps": [
    {
      "order": 1,
      "description": "Check for unauthorized files in flash",
      "commands": [
        "dir disk0:",
        "dir disk1:",
        "verify /md5 disk0:asa*.bin"
      ],
      "platform_notes": "Look for unexpected files. Compare MD5 hashes with Cisco published values."
    },
    {
      "order": 2,
      "description": "Check for Line Dancer implant indicators",
      "commands": [
        "show memory region",
        "show processes cpu-usage",
        "show asp table socket"
      ],
      "platform_notes": "ArcaneDoor used 'Line Dancer' implant. Look for anomalous memory usage or connections."
    },
    {
      "order": 3,
      "description": "If compromised, full device recovery required",
      "commands": [
        "copy tftp://server/asa-clean.bin disk0:asa-clean.bin",
        "boot system disk0:asa-clean.bin",
        "reload"
      ],
      "platform_notes": "CRITICAL: If compromise suspected, reload from known clean image. Do NOT trust existing flash."
    },
    {
      "order": 4,
      "description": "Harden administrative access",
      "commands": [
        "aaa authentication ssh console LOCAL",
        "aaa authorization exec LOCAL",
        "username admin password <strong> privilege 15",
        "ssh timeout 5",
        "ssh version 2"
      ],
      "platform_notes": "Use strong passwords, enable AAA, limit session timeout."
    }
  ],

  "acl_mitigation": {
    "description": "Restrict administrative access to prevent initial compromise",
    "acl_name": "ADMIN-ACCESS",
    "commands": [
      "access-list ADMIN-ACCESS permit ip host 10.0.0.5 any",
      "access-list ADMIN-ACCESS permit ip host 10.0.0.6 any",
      "access-list ADMIN-ACCESS deny ip any any log",
      "!",
      "ssh 10.0.0.5 255.255.255.255 inside",
      "ssh 10.0.0.6 255.255.255.255 inside"
    ],
    "apply_to": "SSH access - limit to specific admin workstations"
  },

  "recommended_fix": "Upgrade to latest ASA/FTD version + integrity verification",

  "upgrade_path": "ASA: 9.16.4.57+, 9.18.4.22+, 9.20.2.10+. FTD: 7.0.6.2+, 7.2.8.1+, 7.4.1.1+. IMPORTANT: After upgrade, verify flash integrity.",

  "detection": {
    "description": "Detect ArcaneDoor/Line Dancer compromise",
    "commands": [
      "dir disk0:",
      "show version",
      "show running-config",
      "show logging | include write mem"
    ],
    "vulnerable_if": "Running affected version. Compromised if: unexpected files in flash, anomalous 'write mem' events, unknown config changes."
  },

  "verification": {
    "description": "Verify system integrity",
    "commands": [
      "verify /md5 disk0:asa*.bin",
      "show running-config | include username",
      "show aaa-server"
    ],
    "expected_output": "MD5 matches Cisco published hash. Only known admin users. No unauthorized AAA servers."
  },

  "cisco_psirt": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-persist-rce-FLsNXF4h",
  "field_notice": null,
  "cisa_alert": "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-108a",

  "tags": ["asa", "ftd", "firewall", "backdoor", "persistence", "arcanedoor", "state-sponsored", "high"],
  "last_updated": "2026-02-16"
}
