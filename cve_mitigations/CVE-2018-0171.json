{
  "cve_id": "CVE-2018-0171",

  "risk_summary": "Smart Install RCE - classic vulnerability still widely exploited. Unauthenticated remote attacker can execute arbitrary code. CVSS 9.8. Thousands of devices still vulnerable in 2026.",

  "attack_vector": "Attacker sends crafted Smart Install messages to TCP port 4786. No authentication required. Results in remote code execution or device reload. Massively exploited by botnets.",

  "workaround_steps": [
    {
      "order": 1,
      "description": "Disable Smart Install (RECOMMENDED)",
      "commands": [
        "configure terminal",
        "no vstack",
        "end",
        "write memory"
      ],
      "platform_notes": "This completely disables Smart Install. If you don't use Smart Install for zero-touch provisioning, disable it."
    },
    {
      "order": 2,
      "description": "Verify Smart Install is disabled",
      "commands": [
        "show vstack config",
        "show tcp brief all | include 4786"
      ],
      "platform_notes": "Should show 'Role: NA' and no listening on port 4786."
    },
    {
      "order": 3,
      "description": "If Smart Install required, use ACL to restrict",
      "commands": [
        "configure terminal",
        "ip access-list extended SMART-INSTALL-FILTER",
        " permit tcp host 10.0.0.1 any eq 4786",
        " deny tcp any any eq 4786 log",
        " permit ip any any",
        "interface GigabitEthernet0/0",
        " ip access-group SMART-INSTALL-FILTER in",
        "end",
        "write memory"
      ],
      "platform_notes": "Only allow Smart Install from trusted director IP (10.0.0.1). Apply to all untrusted interfaces."
    },
    {
      "order": 4,
      "description": "Block port 4786 at network perimeter",
      "commands": [
        "! On perimeter firewall/router:",
        "ip access-list extended PERIMETER-IN",
        " deny tcp any any eq 4786 log",
        " ! ... other rules"
      ],
      "platform_notes": "Defense in depth - block at perimeter even if devices are patched."
    }
  ],

  "acl_mitigation": {
    "description": "Block Smart Install traffic except from trusted director",
    "acl_name": "SMART-INSTALL-FILTER",
    "commands": [
      "ip access-list extended SMART-INSTALL-FILTER",
      " remark Allow Smart Install only from director",
      " permit tcp host 10.0.0.1 any eq 4786",
      " remark Block all other Smart Install",
      " deny tcp any any eq 4786 log",
      " remark Allow other traffic",
      " permit ip any any"
    ],
    "apply_to": "All untrusted/external interfaces"
  },

  "recommended_fix": "Disable Smart Install OR upgrade to patched version",

  "upgrade_path": "IOS: 15.2(7)E+, 15.6(3)M+. IOS XE: 16.9.1+. Best practice: disable Smart Install completely unless actively using it.",

  "detection": {
    "description": "Check if Smart Install is enabled and exposed",
    "commands": [
      "show vstack config",
      "show tcp brief all | include 4786",
      "show ip access-lists | include 4786"
    ],
    "vulnerable_if": "Smart Install enabled (Role: Client or Director) AND port 4786 accessible from untrusted networks"
  },

  "verification": {
    "description": "Confirm Smart Install is disabled",
    "commands": [
      "show vstack config",
      "show tcp brief all | include 4786"
    ],
    "expected_output": "Role: NA (disabled). No TCP listener on port 4786."
  },

  "cisco_psirt": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180328-smi2",
  "field_notice": null,
  "cisa_alert": "https://www.cisa.gov/news-events/alerts/2018/04/16/malicious-cyber-actors-continue-target-smart-install-enabled-cisco",

  "tags": ["smart-install", "rce", "classic", "botnet", "critical", "port-4786"],
  "last_updated": "2026-02-16"
}
