{
  "cve_id": "CVE-2024-20291",

  "risk_summary": "Cisco NX-OS CLI command injection. Authenticated attacker with admin credentials can execute arbitrary commands on underlying Linux OS. CVSS 6.0. Affects Nexus 3000, 7000, 9000 series switches.",

  "attack_vector": "Attacker with valid admin CLI access sends crafted commands. Insufficient input validation in CLI allows escape to underlying Linux shell. Results in full control of switch operating system.",

  "workaround_steps": [
    {
      "order": 1,
      "description": "Restrict admin access to trusted personnel only",
      "commands": [
        "show users",
        "show running-config | include username",
        "! Remove unnecessary admin accounts",
        "configure terminal",
        "no username <unnecessary-user>",
        "! Use role-based access control (RBAC)"
      ],
      "platform_notes": "Principle of least privilege. Fewer admins = smaller attack surface."
    },
    {
      "order": 2,
      "description": "Implement AAA with TACACS+/RADIUS",
      "commands": [
        "configure terminal",
        "feature tacacs+",
        "tacacs-server host <server-ip> key <secret>",
        "aaa group server tacacs+ TACACS-SERVERS",
        "  server <server-ip>",
        "aaa authentication login default group TACACS-SERVERS local",
        "aaa authorization commands default group TACACS-SERVERS local",
        "aaa accounting default group TACACS-SERVERS"
      ],
      "platform_notes": "Centralized auth with command authorization and logging."
    },
    {
      "order": 3,
      "description": "Enable command authorization",
      "commands": [
        "configure terminal",
        "aaa authorization commands default group TACACS-SERVERS local",
        "! Configure TACACS+ server to restrict dangerous commands",
        "! Audit all admin commands"
      ],
      "platform_notes": "Log and restrict privileged commands via AAA server."
    },
    {
      "order": 4,
      "description": "Monitor for suspicious activity",
      "commands": [
        "show logging last 100",
        "show accounting log",
        "show users",
        "! Configure syslog export",
        "logging server <syslog-ip>",
        "logging level authpriv 6"
      ],
      "platform_notes": "Monitor for unusual CLI activity or unexpected commands."
    }
  ],

  "acl_mitigation": {
    "description": "Restrict management access to switch",
    "acl_name": "MGMT-ACCESS",
    "commands": [
      "ip access-list MGMT-ACCESS",
      "  permit tcp 10.0.0.0/24 any eq 22",
      "  deny ip any any log",
      "!",
      "line vty",
      "  access-class MGMT-ACCESS in"
    ],
    "apply_to": "VTY lines and management interface"
  },

  "recommended_fix": "Upgrade to NX-OS 9.3(13)+, 10.2(7)+, 10.3(5)+ or later",

  "upgrade_path": "Check Cisco advisory for your specific Nexus platform. Nexus 3000, 7000, 9000 series affected. Plan maintenance window.",

  "detection": {
    "description": "Check NX-OS version and admin accounts",
    "commands": [
      "show version | include 'NXOS\\|version'",
      "show users",
      "show running-config | include username"
    ],
    "vulnerable_if": "NX-OS version below fixed release AND admin accounts exist"
  },

  "verification": {
    "description": "Confirm patched version and access controls",
    "commands": [
      "show version | include version",
      "show aaa authentication",
      "show running-config | include tacacs"
    ],
    "expected_output": "NX-OS version 9.3(13)+/10.2(7)+/10.3(5)+ AND AAA configured"
  },

  "cisco_psirt": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-nxos-cmd-injection-xD9OhyOP",
  "field_notice": null,
  "cisa_alert": null,

  "tags": ["nx-os", "nexus", "nexus-3000", "nexus-7000", "nexus-9000", "command-injection", "datacenter", "medium"],
  "last_updated": "2026-02-21"
}
