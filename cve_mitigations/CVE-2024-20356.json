{
  "cve_id": "CVE-2024-20356",

  "risk_summary": "Cisco IMC (Integrated Management Controller) command injection. Authenticated attacker with admin access can execute arbitrary commands on underlying OS. CVSS 8.7. Affects UCS servers and other IMC-enabled hardware.",

  "attack_vector": "Attacker with valid admin credentials to IMC web interface sends crafted request. Command injection in web UI leads to OS-level command execution. Full system compromise possible.",

  "workaround_steps": [
    {
      "order": 1,
      "description": "Restrict IMC access to management network only",
      "commands": [
        "# Via IMC Web UI:",
        "# Admin > Network > Network Settings",
        "# Ensure IMC is only on dedicated management VLAN",
        "# Block IMC ports (443, 80) from user networks"
      ],
      "platform_notes": "IMC should never be accessible from untrusted networks."
    },
    {
      "order": 2,
      "description": "Review and audit admin accounts",
      "commands": [
        "# Via IMC Web UI:",
        "# Admin > User Management",
        "# Remove unnecessary admin accounts",
        "# Enable strong password policy",
        "# Consider LDAP/AD integration with MFA"
      ],
      "platform_notes": "Limit admin access to essential personnel only."
    },
    {
      "order": 3,
      "description": "Enable audit logging",
      "commands": [
        "# Via IMC Web UI:",
        "# Admin > System Event Log",
        "# Configure remote syslog destination",
        "# Monitor for unusual admin activity"
      ],
      "platform_notes": "Logs help detect exploitation attempts."
    },
    {
      "order": 4,
      "description": "Use CIMC through Cisco Intersight (cloud-managed)",
      "commands": [
        "# If using Intersight:",
        "# Manage IMC through Intersight portal",
        "# Disable direct IMC web access if possible",
        "# Intersight provides additional security controls"
      ],
      "platform_notes": "Intersight adds layer of access control and auditing."
    }
  ],

  "acl_mitigation": {
    "description": "Firewall rules to restrict IMC access",
    "acl_name": "IMC-MGMT-ONLY",
    "commands": [
      "# On upstream firewall/switch:",
      "ip access-list extended IMC-MGMT-ONLY",
      " permit tcp 10.0.0.0 0.0.0.255 host <IMC-IP> eq 443",
      " permit tcp 10.0.0.0 0.0.0.255 host <IMC-IP> eq 22",
      " deny ip any host <IMC-IP> log"
    ],
    "apply_to": "Network segments with IMC access"
  },

  "recommended_fix": "Upgrade to IMC firmware 4.3(2.240009) or later",

  "upgrade_path": "Check Cisco advisory for your specific UCS model. IMC updates typically done via Host Upgrade Utility (HUU) or Intersight.",

  "detection": {
    "description": "Check if IMC is exposed",
    "commands": [
      "# From management workstation:",
      "# curl -I https://<IMC-IP>",
      "# If accessible from non-mgmt network = RISK",
      "# Check IMC version in web UI: System Information"
    ],
    "vulnerable_if": "IMC version below 4.3(2.240009) AND accessible to untrusted users"
  },

  "verification": {
    "description": "Confirm IMC updated and access restricted",
    "commands": [
      "# Check version via IMC web UI",
      "# Verify network segmentation",
      "# Test access from non-management network (should fail)"
    ],
    "expected_output": "IMC version 4.3(2.240009)+ AND access only from management network"
  },

  "cisco_psirt": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-cimc-cmd-inj-mUx4c5AJ",
  "field_notice": null,
  "cisa_alert": null,

  "tags": ["imc", "ucs", "cimc", "command-injection", "server", "hardware", "high"],
  "last_updated": "2026-02-21"
}
