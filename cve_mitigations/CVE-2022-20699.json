{
  "cve_id": "CVE-2022-20699",

  "risk_summary": "SSL VPN double-free vulnerability leading to RCE. Unauthenticated attacker can crash device or execute code. CVSS 10.0 - maximum severity. Affects Cisco Small Business RV series.",

  "attack_vector": "Attacker sends crafted HTTPS request to SSL VPN interface. Double-free memory corruption leads to denial of service or arbitrary code execution. No authentication required.",

  "workaround_steps": [
    {
      "order": 1,
      "description": "Disable SSL VPN if not required",
      "commands": [
        "# Via Web UI:",
        "# VPN > SSL VPN",
        "# Uncheck 'Enable SSL VPN'",
        "# Click Save"
      ],
      "platform_notes": "RV340/RV345 series. Best mitigation if SSL VPN not needed."
    },
    {
      "order": 2,
      "description": "Check current firmware version",
      "commands": [
        "# Via Web UI:",
        "# Status > System Summary",
        "# Note 'Firmware Version'",
        "# Compare with patched versions"
      ],
      "platform_notes": "Update to latest firmware if SSL VPN required."
    },
    {
      "order": 3,
      "description": "Restrict VPN access with firewall rules",
      "commands": [
        "# Via Web UI:",
        "# Firewall > Access Rules",
        "# Limit SSL VPN port (443) to specific source IPs if possible"
      ],
      "platform_notes": "Reduces attack surface but doesn't fully mitigate."
    },
    {
      "order": 4,
      "description": "Monitor for crashes or anomalies",
      "commands": [
        "# Via Web UI:",
        "# Status > System Logs",
        "# Look for crash events or unexpected reboots"
      ],
      "platform_notes": "Exploitation may cause device crashes."
    }
  ],

  "acl_mitigation": {
    "description": "Limit SSL VPN access to known IP ranges",
    "acl_name": "VPN-RESTRICT",
    "commands": [
      "# Via Web UI - Firewall > Access Rules:",
      "# Create rule allowing HTTPS (443) only from specific IPs",
      "# Deny all other WAN access to port 443"
    ],
    "apply_to": "WAN firewall rules for port 443"
  },

  "recommended_fix": "Upgrade to firmware 1.0.03.26 or later",

  "upgrade_path": "RV340: 1.0.03.26+, RV340W: 1.0.03.26+, RV345: 1.0.03.26+, RV345P: 1.0.03.26+. Download from Cisco Software Center.",

  "detection": {
    "description": "Check if SSL VPN is enabled and version is vulnerable",
    "commands": [
      "# Via Web UI:",
      "# VPN > SSL VPN - check if enabled",
      "# Status > System Summary - check firmware version"
    ],
    "vulnerable_if": "SSL VPN enabled AND firmware version below 1.0.03.26"
  },

  "verification": {
    "description": "Confirm patched version or SSL VPN disabled",
    "commands": [
      "# Via Web UI:",
      "# Status > System Summary",
      "# Verify firmware >= 1.0.03.26"
    ],
    "expected_output": "Firmware version 1.0.03.26 or higher, or SSL VPN disabled"
  },

  "cisco_psirt": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-smb-mult-vuln-KA9PK6D",
  "field_notice": null,
  "cisa_alert": null,

  "tags": ["rv340", "rv345", "ssl-vpn", "rce", "critical", "double-free", "unauthenticated"],
  "last_updated": "2026-02-18"
}
