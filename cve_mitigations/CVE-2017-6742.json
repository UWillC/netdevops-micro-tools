{
  "cve_id": "CVE-2017-6742",

  "risk_summary": "SNMP Remote Code Execution - classic vulnerability. Attacker with SNMP community string can execute arbitrary code. CVSS 8.8. Part of larger SNMP vulnerability set (EXTRABACON).",

  "attack_vector": "Attacker sends crafted SNMP packets to device. Requires valid community string (often default 'public' or 'private'). Buffer overflow leads to code execution with root privileges.",

  "workaround_steps": [
    {
      "order": 1,
      "description": "Disable SNMP if not required",
      "commands": [
        "configure terminal",
        "no snmp-server",
        "end",
        "write memory"
      ],
      "platform_notes": "Best mitigation. If you don't need SNMP, disable it completely."
    },
    {
      "order": 2,
      "description": "If SNMP required, upgrade to SNMPv3",
      "commands": [
        "configure terminal",
        "no snmp-server community public",
        "no snmp-server community private",
        "snmp-server group ADMIN-GROUP v3 priv",
        "snmp-server user snmp-admin ADMIN-GROUP v3 auth sha AuthPass123 priv aes 256 PrivPass123",
        "snmp-server host 10.0.0.1 version 3 priv snmp-admin",
        "end",
        "write memory"
      ],
      "platform_notes": "SNMPv3 with auth+priv is not vulnerable to this attack."
    },
    {
      "order": 3,
      "description": "Restrict SNMP access with ACL",
      "commands": [
        "configure terminal",
        "access-list 99 permit 10.0.0.0 0.0.0.255",
        "access-list 99 deny any log",
        "snmp-server community <string> RO 99",
        "end",
        "write memory"
      ],
      "platform_notes": "Limit SNMP access to management network only."
    },
    {
      "order": 4,
      "description": "Check for default communities",
      "commands": [
        "show running-config | include snmp-server community",
        "show snmp community"
      ],
      "platform_notes": "Remove any default communities (public, private)."
    }
  ],

  "acl_mitigation": {
    "description": "Restrict SNMP to trusted management hosts only",
    "acl_name": "SNMP-ACCESS",
    "commands": [
      "access-list 99 remark SNMP Management Access",
      "access-list 99 permit 10.0.0.5 0.0.0.0",
      "access-list 99 permit 10.0.0.6 0.0.0.0",
      "access-list 99 deny any log",
      "!",
      "snmp-server community <string> RO 99"
    ],
    "apply_to": "SNMP community ACL"
  },

  "recommended_fix": "Upgrade to patched version AND migrate to SNMPv3",

  "upgrade_path": "IOS: 15.1+, IOS XE: 16.x+. Best practice: disable SNMPv1/v2c completely, use SNMPv3 with auth+priv.",

  "detection": {
    "description": "Check SNMP configuration for vulnerabilities",
    "commands": [
      "show snmp",
      "show snmp community",
      "show running-config | include snmp-server"
    ],
    "vulnerable_if": "SNMPv1 or v2c enabled with default or weak community strings, no ACL restriction"
  },

  "verification": {
    "description": "Confirm SNMPv3 only or SNMP disabled",
    "commands": [
      "show snmp",
      "show snmp group",
      "show snmp user"
    ],
    "expected_output": "Only SNMPv3 groups/users configured OR SNMP disabled"
  },

  "cisco_psirt": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20170629-snmp",
  "field_notice": null,
  "cisa_alert": null,

  "tags": ["snmp", "rce", "buffer-overflow", "classic", "high", "extrabacon"],
  "last_updated": "2026-02-18"
}
